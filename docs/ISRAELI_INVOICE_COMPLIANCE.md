# ๐ ISRAELI_INVOICE_COMPLIANCE.md

## LogiRoute โ ะขัะตะฑะพะฒะฐะฝะธั ะบ ะธะทัะฐะธะปััะบะธะผ ะฝะฐะปะพะณะพะฒัะผ ะดะพะบัะผะตะฝัะฐะผ

> ะัะฐะบัะธัะตัะบะธะน ัะฟัะฐะฒะพัะฝะธะบ ะดะปั ัะฐะทัะฐะฑะพัะบะธ. ะะต ัะฒะปัะตััั ััะธะดะธัะตัะบะพะน ะบะพะฝััะปััะฐัะธะตะน.

---

## 1๏ธโฃ Checklist ัะพะพัะฒะตัััะฒะธั (ืืฉืืืืืช ืืก / ืืฉืืืืืช ืืก-ืงืืื / ืงืืื)

### A. ะะฑัะทะฐัะตะปัะฝัะต ัะตะบะฒะธะทะธัั ะฝะฐ PDF

- ะะฐะณะพะปะพะฒะพะบ ะดะพะบัะผะตะฝัะฐ: `ืืฉืืืืืช ืืก` / `ืืฉืืืืืช ืืก-ืงืืื` / `ืงืืื`
- ะะฐะฝะฝัะต ะฟัะพะดะฐะฒัะฐ: ะฝะฐะทะฒะฐะฝะธะต/ะธะผั, `ืข.ื` / `ื.ืค`, ะฐะดัะตั, ัะตะปะตัะพะฝ/email
- ะะพะผะตั ะดะพะบัะผะตะฝัะฐ (ัะตัะธะนะฝัะน, ัะฝะธะบะฐะปัะฝัะน)
- ะะฐัะฐ ะดะพะบัะผะตะฝัะฐ
- ะะฐะฝะฝัะต ะบะปะธะตะฝัะฐ: ะธะผั/ะฝะฐะทะฒะฐะฝะธะต; ะดะปั B2B โ `ื.ืค`/`ืข.ื`, ะฐะดัะตั
- ะขะฐะฑะปะธัะฐ ะฟะพะทะธัะธะน: ะพะฟะธัะฐะฝะธะต, ะบะพะปะธัะตััะฒะพ, ัะตะฝะฐ, ััะผะผะฐ (ะฟะพัััะพัะฝะพ)
- ะกัะผะผะฐ ะฑะตะท ะะะก, ััะฐะฒะบะฐ ะะะก, ััะผะผะฐ ะะะก, ะธัะพะณ ะบ ะพะฟะปะฐัะต
- ะะฐะปััะฐ (ะตัะปะธ ะฝะต โช) ะธ ััะปะพะฒะธั ะพะฟะปะฐัั (ัะตะบะพะผะตะฝะดัะตััั)
- ะกััะปะบะฐ ะฝะฐ ะทะฐะบะฐะท/ะดะพััะฐะฒะบั/ะฝะฐะบะปะฐะดะฝัั (ะตัะปะธ ะตััั)

ะะฑัะฐั ะพะฑัะทะฐะฝะฝะพััั ะฒัะดะฐะฒะฐัั ะฝะฐะปะพะณะพะฒัะต ะดะพะบัะผะตะฝัั ะธ ะฒะตััะธ ัััั โ ัะฐััั ััะตะฑะพะฒะฐะฝะธะน "ืืืืื ืกืคืจืื".

### B. ะัะผะตัะฐัะธั ะธ ะฝะตะธะทะผะตะฝัะตะผะพััั

- ะัะผะตัะฐัะธั ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะฐั, ะฑะตะท ะฟัะพะฟััะบะพะฒ ะธ ะฟะพะฒัะพัะพะฒ โ ะบัะธัะธัะฝะพ ะฟัะธ ะฟัะพะฒะตัะบะฐั
- ะะพัะปะต ะฒัะฟััะบะฐ ะดะพะบัะผะตะฝั ะฝะตะปัะทั ัะตะดะฐะบัะธัะพะฒะฐัั
- ะัะฟัะฐะฒะปะตะฝะธั โ ัะตัะตะท `ืืฉืืืืืช ืืืืื` / `ืืกืื ืืชืงื` (credit note), ะฝะต ัะตะดะฐะบัะธัะพะฒะฐะฝะธะตะผ ััะฐัะพะณะพ

### C. ะะพะณะดะฐ ะบะฐะบะพะน ะดะพะบัะผะตะฝั ะฒัะดะฐัััั

- `ืขืืกืง ืืืจืฉื` / `ืืืจื` โ ะพะฑัะทะฐะฝ ะฒัะดะฐะฒะฐัั `ืืฉืืืืืช ืืก` ะทะฐ ะพะฑะปะฐะณะฐะตะผัั ัะดะตะปะบั
- `ืงืืื` โ ะฒัะตะณะดะฐ ะฟัะพ ัะฐะบั ะฟะพะปััะตะฝะธั ะดะตะฝะตะณ (ะฟะพะปะฝะฐั/ัะฐััะธัะฝะฐั ะพะฟะปะฐัะฐ)
- `ืืฉืืืืืช ืืก-ืงืืื` โ ะบะพะผะฑะพ: ะะะก-ะธะฝะฒะพะนั + ะฟะพะดัะฒะตัะถะดะตะฝะธะต ะพะฟะปะฐัั (ะฟัะธ ะพะฟะปะฐัะต ััะฐะทั)

### D. ืืฉืืืืืืช ืืฉืจืื / ืืกืคืจ ืืงืฆืื

- ะะตะณัะปััะธั "ืืฉืืืืืืช ืืฉืจืื": ะดะปั ะฝะตะบะพัะพััั ััะผะผ/ััะตะฝะฐัะธะตะฒ ะฝัะถะตะฝ `ืืกืคืจ ืืงืฆืื` ะพั ืจืฉืืช ืืืกืื
- ะะพะบัะฟะฐัะตะปั ะผะพะถะตั ะทะฐัะตััั ะฒัะพะดะฝะพะน ะะะก ัะพะปัะบะพ ะฟัะธ ะฝะฐะปะธัะธะธ ััะพะณะพ ะฝะพะผะตัะฐ (ะฒััะต ะฟะพัะพะณะฐ)
- ะะพัะพะณ ะธ ะดะฐัั ะผะตะฝััััั ะฟะพ ััะฐะฟะฐะผ โ ััะฐะฝะธัั ะบะฐะบ ะฝะฐัััะพะนะบั, ะฝะต ัะฐัะดะบะพะด

### E. ะฅัะฐะฝะตะฝะธะต

- ะะพะบัะผะตะฝัั ะธ ััััะฝัะต ะดะฐะฝะฝัะต โ ััะฐะฝะธัั ัััะฐะฝะพะฒะปะตะฝะฝัะน ััะพะบ (ะฟัะฐะบัะธะบะฐ: 7 ะปะตั)
- ะขะพัะฝัะน ัะตะถะธะผ ะทะฐะฒะธัะธั ะพั ะฒะธะดะฐ ะดะพะบัะผะตะฝัะพะฒ ะธ ะฟัะฐะฒะธะป "ืืืืื ืกืคืจืื"

---

## 2๏ธโฃ ะกัััะบัััะฐ PDF (Priority/Hashavshevet-ััะธะปั)

### (1) Header

- ะะพะณะพ (ะพะฟัะธะพะฝะฐะปัะฝะพ)
- ะะฐะทะฒะฐะฝะธะต ะดะพะบัะผะตะฝัะฐ (ะบััะฟะฝะพ)
- ะะปะพะบ ะฟัะพะดะฐะฒัะฐ: `ืฉื ืืขืกืง` + `ืข.ื`/`ื.ืค` + ะฐะดัะตั + ะบะพะฝัะฐะบัั

### (2) ะะปะพะบ ะดะพะบัะผะตะฝัะฐ

- โ ะดะพะบัะผะตะฝัะฐ (ะบััะฟะฝะพ), ะดะฐัะฐ
- ะะพะผะตั ะทะฐะบะฐะทะฐ/ะดะพััะฐะฒะบะธ/ัััะปะบะธ (`ืืกืืืชืืืช`) โ ะตัะปะธ ะตััั

### (3) ะะปะพะบ ะบะปะธะตะฝัะฐ

- `ืืืืื` + `ืฉื ืืงืื`, `ื.ืค`/`ืข.ื`, ะฐะดัะตั

### (4) ะขะฐะฑะปะธัะฐ ะฟะพะทะธัะธะน

| ืชืืืืจ | ืืืืช | ืืืืจ | ืืืื | ืกืืื |
|-------|------|------|------|------|

ะ ะปะพะณะธััะธะบะต ัะฐััะพ ะดะพะฑะฐะฒะปััั: ัะบะปะฐะด/ะผะฐััััั/ะฝะพะผะตั ะฝะฐะบะปะฐะดะฝะพะน

### (5) ะัะพะณะธ

- `ืกืืดื ืืคืื ืืขืดื`
- `ืืขืดื` (ะพะฑััะฝะพ 18%)
- `ืกืืดื ืืชืฉืืื`
- ะัะปะธ ะฝะตัะบะพะปัะบะพ ััะฐะฒะพะบ โ ัะฐะทะฑะธะฒะบะฐ ะฟะพ ััะฐะฒะบะฐะผ

### (6) ะะฟะปะฐัะฐ

- ะกะฟะพัะพะฑ ะพะฟะปะฐัั, ัะตัะตัะตะฝั ััะฐะฝะทะฐะบัะธะธ
- ะัะปะธ ัะฐััะธัะฝะฐั โ `ืืชืจื ืืชืฉืืื`

### (7) Footer

- ะัะธะผะตัะฐะฝะธั, ััะปะพะฒะธั, ะฟะพะดะฟะธัั/ะฟะตัะฐัั (ะพะฟัะธะพะฝะฐะปัะฝะพ)

---

## 3๏ธโฃ ะะฐะทะฝะธัะฐ ัะธะฟะพะฒ ะดะพะบัะผะตะฝัะพะฒ

| ะขะธะฟ | ะะฐะทะฝะฐัะตะฝะธะต |
|-----|-----------|
| `ืืฉืืืืืช ืืก` | ะะพะบัะผะตะฝั ะพ ัะดะตะปะบะต ั ะะะก (ะฝะฐัะธัะปัะตั ืืขืดื). ะะฟะปะฐัั ัะฐะผ ะฟะพ ัะตะฑะต ะฝะต ะฟะพะดัะฒะตัะถะดะฐะตั. |
| `ืงืืื` | ะะพะบัะผะตะฝั ะพ ะฟะพะปััะตะฝะธะธ ะดะตะฝะตะณ. ะะพะถะตั ะฑััั ะฑะตะท ะะะก-ัะฐััะธ. |
| `ืืฉืืืืืช ืืก-ืงืืื` | ะะพะผะฑะพ: ะะะก-ะธะฝะฒะพะนั + ะบะฒะธัะฐะฝัะธั. ะัะฟะพะปัะทััั ะฟัะธ ะพะฟะปะฐัะต ััะฐะทั (ะฝะฐะป/ะบะฐััะฐ/ะฟะตัะตะฒะพะด ะฑะตะท ะพัััะพัะบะธ). |

---

## 4๏ธโฃ JSON-ะผะพะดะตะปั (ะผะธะฝะธะผัะผ + ะณะพัะพะฒะพ ะดะปั PDF/ะฐัะดะธัะฐ)

```json
{
  "docType": "TAX_INVOICE_RECEIPT",
  "docNumber": "INV-000123",
  "issueDate": "2026-02-26",
  "taxPointDate": "2026-02-26",
  "currency": "ILS",

  "seller": {
    "name": "__________________",
    "vatId": "___________",
    "address": "__________________",
    "phone": "__________________",
    "email": "__________________"
  },

  "buyer": {
    "name": "__________________",
    "vatId": "___________",
    "address": "__________________"
  },

  "lines": [
    {
      "sku": null,
      "description": "__________________",
      "quantity": 1,
      "unitPrice": 0.0,
      "discountPercent": 0.0,
      "vatRate": 0.18,
      "metadata": {
        "routeId": null,
        "shipmentId": null,
        "warehouseId": null
      }
    }
  ],

  "totals": {
    "subTotal": 0.0,
    "vatTotal": 0.0,
    "grandTotal": 0.0
  },

  "payments": [
    {
      "method": "CARD",
      "paidAt": "2026-02-26T12:00:00+02:00",
      "amount": 0.0,
      "transactionRef": "__________"
    }
  ],

  "references": {
    "orderId": "__________",
    "deliveryNoteId": "__________"
  },

  "israelInvoices": {
    "allocationNumber": null,
    "allocationStatus": "NOT_REQUIRED"
  },

  "audit": {
    "createdAt": "2026-02-26T12:00:00+02:00",
    "createdByUid": "__________",
    "locked": true,
    "pdfSha256": "__________"
  }
}
```

ะะปััะตะฒะพะต ะดะปั ะฝะฐะปะพะณะพะฒะพะน ะปะพะณะธะบะธ:
- `docNumber` โ ัะตัะธะนะฝะพััั
- `locked` + `pdfSha256` โ ะฝะตะปัะทั "ัะธัะพ ะฟะพะดะฟัะฐะฒะธัั"
- `allocationNumber` โ ะดะปั "ืืฉืืืืืืช ืืฉืจืื", ะตัะปะธ ััะตะฑัะตััั

---

## 5๏ธโฃ ะะฐะบ ะดะตะปะฐัั Priority / ืืฉืืฉืืช

### Priority (ัะธะฟะธัะฝะฐั ะปะพะณะธะบะฐ)

- ะกะพะทะดะฐัั ะดะพะบัะผะตะฝั `ืืฉืืืืืช ืืก` ะฒ ะผะพะดัะปะต ะฟัะพะดะฐะถ/ัะธะฝะฐะฝัะพะฒ
- ะะพะผะตั ะผะพะถะตั ะฑััั ะฒัะตะผะตะฝะฝัะน/ัะตัะฝะพะฒะธะบ, ะฟัะธ ะฒัะฟััะบะต โ ัะธะฝะฐะปัะฝัะน
- ะะบะปะฐะดะบะธ `ืืืืจืื`/`ืืกืืืชืืืช` ะดะปั ะฟัะธะฒัะทะพะบ ะบ ะทะฐะบะฐะทะฐะผ/ะฟะพััะฐะฒะบะฐะผ (ERP-style)
- ะะฝัะตะณัะฐัะธั ะฟะพะปััะตะฝะธั `ืืกืคืจ ืืงืฆืื` ะฟััะผะพ ะธะท ัะธััะตะผั

### ืืฉืืฉืืช (ะพะฑัะตะต ะฟะพะฒะตะดะตะฝะธะต ะฑัั-ัะธััะตะผ)

- ะัััะบะฐั ัะตัะธะนะฝะพััั ะธ ะฑะปะพะบะธัะพะฒะบะฐ ะดะพะบัะผะตะฝัะฐ ะฟะพัะปะต ะฟะตัะฐัะธ/ะฒัะฟััะบะฐ
- ะัะฟัะฐะฒะปะตะฝะธั ัะตัะตะท `ืืืืื`/`ืืกืื ืืชืงื`
- ะฃะฟะพั ะฝะฐ ะพััััะฝะพััั ะฟะพ `ืืขืดื` ะธ "ะบะฝะธะณะฐ ะดะพะบัะผะตะฝัะพะฒ" (`ืกืคืจ ืชืงืืืืื`/`ืกืคืจ ืืฉืืืืืืช`)

### ะงัะพ ะฟะพะฒัะพัะธัั ะฒ LogiRoute

- ะกะพััะพัะฝะธั ะดะพะบัะผะตะฝัะฐ: `DRAFT` โ `ISSUED` โ `LOCKED`
- ะกะตัะธะนะฝะพััั ะฟะพ ัะธะฟั ะดะพะบัะผะตะฝัะฐ
- Credit note ะฒะผะตััะพ edit
- ะัััะพะธัั ะพะฟัะธะพะฝะฐะปัะฝัะน `allocationNumber` ะบะฐะบ ััะฐะฟ `ISSUE` (ะตัะปะธ ััะตะฑัะตััั)

---

## 6๏ธโฃ ะขะตะบััะฐั ัะตะฐะปะธะทะฐัะธั ะฒ LogiRoute (ััะฐััั ะฝะฐ 27.02.2026)

### ะะตะฐะปะธะทะพะฒะฐะฝะฝัะต ัะธะฟั ะดะพะบัะผะตะฝัะพะฒ

| ะขะธะฟ | Enum | ะะดะต ัะพะทะดะฐัััั | ะกัะฐััั |
|-----|------|--------------|--------|
| ืืฉืืืืืช ืืก | `invoice` | ะะฝะพะฟะบะฐ ะฝะฐ ัะพัะบะต ะดะพััะฐะฒะบะธ (ะทะตะปัะฝะฐั) | โ ะะพัะพะฒะพ |
| ืชืขืืืช ืืฉืืื | `delivery` | ะะฝะพะฟะบะฐ ะฝะฐ ัะพัะบะต ะดะพััะฐะฒะบะธ (ัะธะฝัั) | โ ะะพัะพะฒะพ |
| ืืฉืืืืืช ืืก / ืงืืื | `taxInvoiceReceipt` | ะงะตะบะฑะพะบั "ืชืฉืืื ืืชืงืื" ะฟัะธ ัะพะทะดะฐะฝะธะธ ืืฉืืืืืช | โ ะะพัะพะฒะพ |
| ืงืืื | `receipt` | ะะฝะพะฟะบะฐ ะฝะฐ ัะบัะฐะฝะต ืืืืื ืืฉืืืืืืช (teal) | โ ะะพัะพะฒะพ |
| ืืฉืืืืืช ืืืืื | `creditNote` | ะะฝะพะฟะบะฐ ะฝะฐ ัะบัะฐะฝะต ืืืืื ืืฉืืืืืืช (ะพัะฐะฝะถะตะฒะฐั) | โ ะะพัะพะฒะพ |

### ะะพะปั ะผะพะดะตะปะธ Invoice, ัะฒัะทะฐะฝะฝัะต ั ัะธะฟะฐะผะธ

- `documentType` โ enum `InvoiceDocumentType` (invoice, receipt, delivery, creditNote, taxInvoiceReceipt)
- `paymentMethod` โ String? (ืืืืื / ืืจืืืก ืืฉืจืื / ืืขืืจื ืืืงืืืช / ืฆ'ืง) โ ะดะปั taxInvoiceReceipt ะธ receipt
- `linkedInvoiceId` โ String? โ ะดะปั ืงืืื: ัััะปะบะฐ ะฝะฐ ะพัะธะณะธะฝะฐะปัะฝัั ืืฉืืืืืช; ะดะปั ืืืืื: ัััะปะบะฐ ะฝะฐ ะธััะพะดะฝัะน ะดะพะบัะผะตะฝั
- `deliveryPointId` โ String? โ ะดะปั ะฟัะตะดะพัะฒัะฐัะตะฝะธั ะดัะฑะปะตะน ะฟัะธ ัะพะทะดะฐะฝะธะธ

### PDF: ััะพ ะพัะพะฑัะฐะถะฐะตััั ะฟะพ ัะธะฟั

| ะญะปะตะผะตะฝั | ืืฉืืืืืช ืืก | ืืฉืืืืืช ืืก/ืงืืื | ืงืืื | ืชืขืืืช ืืฉืืื | ืืืืื |
|---------|-----------|----------------|------|------------|-------|
| ะะฐะณะพะปะพะฒะพะบ ะดะพะบัะผะตะฝัะฐ | โ | โ | โ | โ | โ |
| ะขะฐะฑะปะธัะฐ ั ัะตะฝะฐะผะธ | โ | โ | โ | โ | โ |
| ะขะฐะฑะปะธัะฐ ะฑะตะท ัะตะฝ | โ | โ | โ | โ | โ |
| ะัะพะณะธ (ืกืืดื, ืืขืดื) | โ | โ | โ | โ | โ |
| ืชืฉืืื ืขื | โ | โ | โ | โ | โ |
| ืืืคื ืชืฉืืื | โ | โ | โ | โ | โ |
| ะกััะปะบะฐ ะฝะฐ ืืฉืืืืืช | โ | โ | โ | โ | โ |
| ะะพะดะฟะธัั (ืืชืืื) | โ | โ | โ | โ | โ |

### ะัะผะตัะฐัะธั

- ะะฐะถะดัะน ัะธะฟ ะดะพะบัะผะตะฝัะฐ ะธะผะตะตั ัะฒะพะน ัััััะธะบ ะฒ `companies/{companyId}/counters/{docType}`
- ะะพะผะตั ะฟัะธัะฒะฐะธะฒะฐะตััั ะฟัะธ ัะธะฝะฐะปะธะทะฐัะธะธ ัะตัะตะท Firestore transaction
- ะัะฑะปะธ ะฟัะตะดะพัะฒัะฐัะฐัััั ัะตัะตะท ะฟัะพะฒะตัะบั `deliveryPointId` + `documentType` + active status

### ะงัะพ ะตัั ะฝะต ัะตะฐะปะธะทะพะฒะฐะฝะพ

- [ ] ะะพะณะพัะธะฟ ะบะพะผะฟะฐะฝะธะธ-ะบะปะธะตะฝัะฐ ะฒ PDF (ะผะตััะพ ะทะฐัะตะทะตัะฒะธัะพะฒะฐะฝะพ ะฒ ัะตะดะตัะต)
- [ ] ื.ืค ะบะปะธะตะฝัะฐ ะฝะฐ PDF (ะฟะพะปะต `vatId` ะตััั ะฒ ะผะพะดะตะปะธ, ะฝะพ ะฝะต ะฒัะฒะพะดะธััั ะฒ PDF)
- [ ] Standalone ัะพะทะดะฐะฝะธะต ืืฉืืืืืช (ะฑะตะท ะฟัะธะฒัะทะบะธ ะบ ัะพัะบะต ะดะพััะฐะฒะบะธ)
- [ ] ะะตะฐะปัะฝัะน API ืจืฉืืช ืืืกืื ะดะปั ืืกืคืจ ืืงืฆืื (ัะตะนัะฐั placeholder)
- [ ] ะะฐัััะฐะธะฒะฐะตะผะฐั ััะฐะฒะบะฐ ะะะก (ัะตะนัะฐั ัะฐัะดะบะพะด 18%)
- [ ] Tracking ััะฐัััะฐ ะพะฟะปะฐัั (ืฉืืื / ืื ืฉืืื / ืฉืืื ืืืงืืช)
