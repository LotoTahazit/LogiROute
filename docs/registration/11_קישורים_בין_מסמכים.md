# קישורים בין מסמכים (Document Links)

## תיאור

המערכת מתעדת קישורים רשמיים בין מסמכים חשבונאיים.
כל קישור הוא append-only — לא ניתן לשינוי או מחיקה.

## סוגי קישורים

| סוג | קוד | תיאור |
|------|------|--------|
| זיכוי לחשבונית | `creditToInvoice` | זיכוי מקושר לחשבונית המקורית |
| חשבונית לתעודת משלוח | `invoiceToDelivery` | חשבונית מקושרת לתעודת משלוח |
| קבלה לחשבונית | `receiptToInvoice` | קבלה מקושרת לחשבונית |
| ביטול | `cancellation` | מסמך ביטול |

## מבנה קישור

```json
{
  "companyId": "מזהה חברה",
  "sourceDocumentId": "מזהה מסמך מקור",
  "sourceDocumentType": "סוג מסמך מקור",
  "sourceSequentialNumber": 5,
  "targetDocumentId": "מזהה מסמך יעד",
  "targetDocumentType": "סוג מסמך יעד",
  "targetSequentialNumber": 42,
  "linkType": "creditToInvoice",
  "createdBy": "מבצע",
  "reason": "סיבה",
  "createdAt": "חותמת זמן שרת"
}
```

## אחסון

- אוסף: `companies/{companyId}/document_links/{linkId}`
- append-only — `allow update: if false; allow delete: if false;`

## יצירת זיכוי

כאשר נוצר מסמך זיכוי:
1. נוצר מסמך חדש מסוג `creditNote` עם סכומים שליליים
2. נוצר קישור `creditToInvoice` בין הזיכוי לחשבונית המקורית
3. נרשמים שני אירועי ביקורת:
   - על החשבונית המקורית: `creditNoteCreated`
   - על הזיכוי: `created`
4. המסמך המקורי **לא משתנה** — רק הקישור מתעד את הקשר
